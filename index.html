<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apresentação - Relatórios Médicos</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: url('public/background.png') no-repeat center center;
            background-size: 100% 100%;
            background-attachment: fixed;
            min-height: 100vh;
            overflow: hidden;
        }

        .presentation-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .slide {
            display: none;
            width: 100%;
            height: calc(100vh - 120px);
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 40px;
            margin: 20px 20px 60px 20px;
            overflow-y: auto;
            animation: slideIn 0.5s ease-out;
        }

        .slide.active {
            display: block;
        }
        
        

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 20px;
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.2em;
            margin: 0;
            font-weight: 600;
        }

        .header p {
            color: #666;
            font-size: 1.1em;
            margin: 10px 0 0 0;
        }

        .content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            align-items: start;
        }

        .section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .section h2 {
            color: #667eea;
            font-size: 1.4em;
            margin-top: 0;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin-bottom: 20px;
        }

        .timeline-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .timeline {
            position: relative;
            padding: 20px 0;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 30px;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(to bottom, #667eea, #764ba2);
            border-radius: 2px;
        }

        .timeline-item {
            position: relative;
            margin-bottom: 40px;
            padding-left: 80px;
        }

        .timeline-marker {
            position: absolute;
            left: 18px;
            top: 8px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: 4px solid #fff;
            box-shadow: 0 0 0 3px #667eea;
            z-index: 2;
        }

        .timeline-content {
            background: #fff;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #667eea;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .timeline-content:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }

        .timeline-date {
            font-size: 0.9em;
            font-weight: 600;
            color: #667eea;
            margin-bottom: 8px;
        }

        .timeline-title {
            font-size: 1.1em;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
        }

        .timeline-description {
            font-size: 0.95em;
            color: #555;
            line-height: 1.5;
        }

        /* Cores personalizadas para a legenda do gráfico Neuropediatria */
        .chartjs-legend-item-0 {
            color: #374151 !important;
        }
        
        .chartjs-legend-item-1 {
            color: #9CA3AF !important;
        }
        
        .chartjs-legend-item-0 .chartjs-legend-marker {
            background-color: #374151 !important;
            border-color: #374151 !important;
        }
        
        .chartjs-legend-item-1 .chartjs-legend-marker {
            background-color: #9CA3AF !important;
            border-color: #9CA3AF !important;
        }

        .summary-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .summary-card {
            background: white;
            border-radius: 10px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border-left: 4px solid #667eea;
            transition: transform 0.3s ease;
        }

        .summary-card:hover {
            transform: translateY(-5px);
        }

        .summary-card h3 {
            margin: 0 0 15px 0;
            color: #2c3e50;
            font-size: 1.2em;
        }

        .summary-card .value {
            font-size: 2em;
            font-weight: 600;
            color: #667eea;
            margin: 10px 0;
        }

        .summary-card .label {
            font-size: 0.95em;
            color: #666;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        .table th, .table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
            font-size: 0.95em;
        }

        .table th {
            background-color: #667eea;
            color: white;
            font-weight: 600;
            text-align: center;
        }

        .table td:first-child {
            font-weight: 600;
            color: #2c3e50;
            text-align: center;
            background-color: #f1f3f4;
        }

        .table tr:hover {
            background-color: #f0f4ff;
            transition: background-color 0.3s ease;
        }

        .highlight {
            background-color: #fff3cd;
            font-style: italic;
        }

        .positive { color: #28a745 !important; }
        .negative { color: #dc3545 !important; }
        .within-limit { border-left-color: #28a745; }
        .over-limit { border-left-color: #dc3545; }

        .navigation {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            background: rgba(255, 255, 255, 0.95);
            padding: 15px 25px;
            border-radius: 50px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            backdrop-filter: blur(10px);
            z-index: 1000;
        }

        .nav-btn {
            background: #667eea;
            color: white;
            border: none;
            border-radius: 25px;
            padding: 12px 20px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .nav-btn:hover {
            background: #5a67d8;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .nav-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .slide-counter {
            display: flex;
            align-items: center;
            gap: 5px;
            margin: 0 15px;
            color: #666;
            font-weight: 500;
        }

        .slide-dots {
            display: flex;
            gap: 8px;
            margin: 0 15px;
        }

        .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ddd;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .dot.active {
            background: #667eea;
            transform: scale(1.2);
        }

        @media (max-width: 768px) {
            .content {
                grid-template-columns: 1fr;
                gap: 30px;
            }
            
            .slide {
                padding: 25px;
                margin: 10px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .chart-container {
                height: 300px;
            }
            
            .navigation {
                flex-wrap: wrap;
                padding: 10px 15px;
            }
            
            .nav-btn {
                padding: 8px 15px;
                font-size: 12px;
            }
        }
        
        /* Modal para ampliar imagem */
        .image-modal {
            display: none;
            position: fixed;
            z-index: 10000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            cursor: pointer;
        }
        
        .image-modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
        }
        
        .image-modal-close {
            position: absolute;
            top: 20px;
            right: 35px;
            color: #fff;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .image-modal-close:hover {
            color: #ccc;
        }
        
        .clickable-image {
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .clickable-image:hover {
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <div class="presentation-container">
        <!-- Slide 1: UPAE Caruaru -->
        <div class="slide active" id="slide1">
            <div class="header">
                <h1>UPAE CARUARU - MINISTRO FERNANDO LYRA</h1>
            </div>
            
            <div class="content" style="display: flex; justify-content: center; align-items: center; height: 100%;">
                <img src="public/UPAE.png" alt="UPAE Logo" style="max-width: 60%; max-height: 60%; object-fit: contain;">
            </div>
        </div>

        <!-- Slide 2: Desempenho Mensal - Executado vs Meta -->
        <div class="slide" id="slide2">
            <div class="header">
                <h1> Desempenho Mensal - Executado vs Meta</h1>
                <p>Comparativo de Consultas Multidisciplinares e Sessões de Reabilitação | Janeiro - Novembro 2025</p>
            </div>
            
            <div class="content">
                <div class="section">
                    <h2> Consultas Multidisciplinares</h2>
                    <div class="chart-container">
                        <canvas id="consultasChart"></canvas>
                    </div>
                </div>
                
                <div class="section">
                    <h2> Sessões de Reabilitação</h2>
                    <div class="chart-container">
                        <canvas id="sessoesChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="summary-section">
                <div class="summary-card">
                    <h3>Consultas - Média Mensal</h3>
                    <div class="value positive">114,4%</div>
                    <div class="label">Meta superada</div>
                </div>
                <div class="summary-card">
                    <h3>Reabilitação - Média Mensal</h3>
                    <div class="value positive">103,9%</div>
                    <div class="label">Meta superada</div>
                </div>
                <div class="summary-card">
                    <h3>Melhor Mês - Consultas</h3>
                    <div class="value positive">130,6%</div>
                    <div class="label">Abril 2025</div>
                </div>
                <div class="summary-card">
                    <h3>Melhor Mês - Reabilitação</h3>
                    <div class="value positive">144,3%</div>
                    <div class="label">Abril 2025</div>
                </div>
            </div>
        </div>

        <!-- Slide 3: Altas/Inclusões -->
        <div class="slide" id="slide3">
            <div class="header">
                <h1>Altas/Inclusões</h1>
            </div>
            
            <div class="content">
                <div class="section">
                    <h2>Altas das Sessões</h2>
                    <div class="chart-container">
                        <canvas id="altasSessoesChart"></canvas>
                    </div>
                </div>
                
                <div class="section">
                    <h2>Inclusões no projeto de Glaucoma</h2>
                    <div class="chart-container">
                        <canvas id="inclusoesGlaucomaChart"></canvas>
                </div>
            </div>
        </div>

            <div class="summary-section" style="margin-top: 30px; padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 10px;">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                    <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                        <h3 style="color: #2c3e50; margin-bottom: 15px; font-size: 18px;">Altas das Sessões</h3>
                        <ul style="list-style: none; padding: 0; margin: 0; color: #555; line-height: 1.8;">
                            <li style="margin-bottom: 10px;">✓ <strong>352 altas</strong> realizadas no período (ago-nov)</li>
                            <li style="margin-bottom: 10px;">✓ <strong>Psicologia</strong> lidera com 202 altas (57% do total)</li>
                            <li style="margin-bottom: 10px;">✓ Crescimento em <strong>Fonoaudiologia</strong> com destaque em novembro (20 altas)</li>
                            <li style="margin-bottom: 10px;">✓ <strong>Fisioterapia</strong> manteve volume estável (~22 altas/mês)</li>
                        </ul>
            </div>
            
                    <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                        <h3 style="color: #2c3e50; margin-bottom: 15px; font-size: 18px;">Projeto Glaucoma</h3>
                        <ul style="list-style: none; padding: 0; margin: 0; color: #555; line-height: 1.8;">
                            <li style="margin-bottom: 10px;">✓ <strong>135 inclusões</strong> no período (ago-nov)</li>
                            <li style="margin-bottom: 10px;">✓ Pico em <strong>setembro</strong> com 59 inclusões</li>
                            <li style="margin-bottom: 10px;">✓ Redução gradual após setembro (20 em out, 15 em nov)</li>
                            <li style="margin-bottom: 10px;">✓ Média de ~34 inclusões/mês no período</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 4: Nutrição -->
        <div class="slide" id="slide4">
            <div class="header">
                <h1>Nutrição</h1>
            </div>
            
            <div class="content" style="grid-template-columns: 1fr 1fr;">
                <div class="section">
                    <h2> Gastos com Almoço</h2>
                    <div class="chart-container">
                        <canvas id="nutricaoAlmocoChart"></canvas>
                    </div>
                </div>
                
                <div class="section">
                    <h2> Desperdiçometro</h2>
                    <div class="chart-container">
                        <canvas id="nutricaoDesperdicioChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="content" style="grid-template-columns: 1fr 1fr; margin-top: 20px;">
                <div class="section">
                    <h2>Nutrição Insumos</h2>
                    <div class="chart-container">
                        <canvas id="nutricaoInsumosChart"></canvas>
                </div>
            </div>

                <div class="section">
                    <h2> AÇÕES DA NUTRIÇÃO</h2>
                    <div class="table-container" style="margin-top: 20px;">
                        <table class="data-table">
                            <thead>
                                <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                    <th style="padding: 15px 20px; text-align: left; font-weight: 600; border: none;">Ação</th>
                                    <th style="padding: 15px 20px; text-align: left; font-weight: 600; border: none;">Descrição</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 30%; font-weight: 500; color: #2c3e50;">Campanha do Desperdício</td>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 70%; color: #555;">Novembro inicio da campanha do desperdicio. Inicio dia 06/11</td>
                                </tr>
                                <tr>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 30%; font-weight: 500; color: #2c3e50;">Redução da Quantidade de Almoço</td>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 70%; color: #555;">Redução da quantidade de almoço solicitada, cinfirmando as quantidades alguns dias antes.</td>
                                </tr>
                                <tr>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 30%; font-weight: 500; color: #2c3e50;">Oferecimento de Marmitas</td>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 70%; color: #555;">Oferecimento de marmitas aos colaboradores. Total de Novembro 81 marmitas.</td>
                                </tr>
                                <tr>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 30%; font-weight: 500; color: #2c3e50;">Mudança do Sistema de Registro</td>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 70%; color: #555;">Mudança do sistema de registro do almoço. Em processo de desenvolvimento pela TI</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 5: Radiologia -->
        <div class="slide" id="slide5">
            <div class="header">
                <h1>Radiologia</h1>
            </div>
            
            <div class="content" style="grid-template-columns: 1fr;">
                <div class="section">
                    <h2>Radiologia Insumos</h2>
                    <div class="chart-container">
                        <canvas id="radiologiaInsumosChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="summary-section">
                <div class="section" style="grid-column: 1 / -1; margin-bottom: 20px;">
                    <h2> ANDAMENTO DA RADIOLOGIA</h2>
                    <div class="table-container" style="margin-top: 20px;">
                        <table class="data-table">
                            <thead>
                                <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                    <th style="padding: 15px 20px; text-align: left; font-weight: 600; border: none;">Ação</th>
                                    <th style="padding: 15px 20px; text-align: left; font-weight: 600; border: none;">Descrição</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 30%; font-weight: 500; color: #2c3e50;">Limpeza dos Cassetes</td>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 70%; color: #555;">Processo de limpeza dos cassetes de raio-X para melhorar a qualidade das imagens obtidas.</td>
                                </tr>
                                <tr>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 30%; font-weight: 500; color: #2c3e50;">PACS</td>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 70%; color: #555;">Inicio dos testes com a empresa e a TI Local- Problemas apresentados no equipamento de densitometria e USG</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 6: Farmácia -->
        <div class="slide" id="slide6">
            <div class="header">
                <h1>Farmácia</h1>
            </div>
            
            <div class="content" style="grid-template-columns: 1fr;">
                <div class="section">
                    <h2>Custos Médios da Farmácia</h2>
                    <div class="chart-container">
                        <canvas id="farmaciaCustosChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="summary-section" style="grid-template-columns: repeat(2, 1fr);">
                <div class="summary-card">
                    <h3>Custo Total</h3>
                    <div class="value">R$ 103.245,17</div>
                    <div class="label">Projetos e Insumos Assistenciais</div>
                </div>
                
                <div class="summary-card">
                    <h3>Maior Custo</h3>
                    <div class="value positive">R$ 66.260,35</div>
                    <div class="label">Projeto Bexiga Neurogênica</div>
                </div>
            </div>
        </div>


        <!-- Slide 7: Análise de Saídas - Centro de Diagnóstico -->
        <div class="slide" id="slide7">
            <div class="header">
                <h1> Análise de Saídas </h1>
                <p>| Novembro de 2025</p>
            </div>
            
            <div class="content">
                <div class="section">
                    <h2> TOP 5 - Itens por Quantidade Movimentada</h2>
                    <div style="overflow-x: auto;">
                        <table class="table" style="font-size: 0.9em;">
                            <thead>
                                <tr>
                                    <th>Posição</th>
                                    <th>Código</th>
                                    <th>Descrição</th>
                                    <th>Quantidade Total</th>
                                    <th>Valor Total</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="background-color: #fff3cd;">
                                    <td style="font-weight: 600; color: #856404;">1º</td>
                                    <td>353</td>
                                    <td>LUVA PARA PROCEDIMENTO NÃO ESTERIL TAMANHO M</td>
                                    <td style="font-weight: 600; color: #28a745;">5.957</td>
                                    <td>R$ 1.119,03</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: 600;">2º</td>
                                    <td>249</td>
                                    <td>CAMPO OPERATORIO COM CADARCO 25X28CM C/S</td>
                                    <td style="font-weight: 600; color: #28a745;">963</td>
                                    <td>R$ 4.928,29</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: 600;">3º</td>
                                    <td>251</td>
                                    <td>COMPRESSA CIRURGICA DE GAZE HIDROFILA ESTERIL 7,5X7,5CM 11 F</td>
                                    <td style="font-weight: 600; color: #28a745;">900</td>
                                    <td>R$ 395,61</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: 600;">4º</td>
                                    <td>371</td>
                                    <td>SERINGA DESCARTÁVEL 10ML S/ AGULHA (BICO OU ROSCA)</td>
                                    <td style="font-weight: 600; color: #28a745;">871</td>
                                    <td>R$ 210,89</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: 600;">5º</td>
                                    <td>3465</td>
                                    <td>AGULHA HIPODERMICA 0,7X25MM 22G 1 C/ DISP. DE SEGURANÇA</td>
                                    <td style="font-weight: 600; color: #28a745;">830</td>
                                    <td>R$ 239,40</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="section">
                    <h2> TOP 5 - Itens por Valor Total Gasto</h2>
                    <div style="overflow-x: auto;">
                        <table class="table" style="font-size: 0.9em;">
                            <thead>
                                <tr>
                                    <th>Posição</th>
                                    <th>Código</th>
                                    <th>Descrição</th>
                                    <th>Quantidade Total</th>
                                    <th>Valor Total</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="background-color: #fff3cd;">
                                    <td style="font-weight: 600; color: #856404;">1º</td>
                                    <td>2909</td>
                                    <td>CATETER URINARIO REVEST HIDROFILICO LUBRIF STANDARD MASC CH10</td>
                                    <td>1.530</td>
                                    <td style="font-weight: 600; color: #dc3545;">R$ 20.151,92</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: 600;">2º</td>
                                    <td>2578</td>
                                    <td>BOLSA P/ COLOSTOMIA DRENAVEL TRANSP 1PEÇA RECORTAVEL 10-76MM</td>
                                    <td>264</td>
                                    <td style="font-weight: 600; color: #dc3545;">R$ 5.037,12</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: 600;">3º</td>
                                    <td>2910</td>
                                    <td>CATETER URINARIO REVEST HIDROFILICO LUBRIF STANDARD FEM CH10</td>
                                    <td>240</td>
                                    <td style="font-weight: 600; color: #dc3545;">R$ 3.160,12</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: 600;">4º</td>
                                    <td>2911</td>
                                    <td>CATETER URINARIO REVEST HIDROFILICO LUBRIF STANDARD MASC CH12</td>
                                    <td>210</td>
                                    <td style="font-weight: 600; color: #dc3545;">R$ 2.751,10</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: 600;">5º</td>
                                    <td>2784</td>
                                    <td>BOLSA COLOSTOMIA DRENAVEL TRANSP. RECORT.1 PEÇA MAXI 10-80MM</td>
                                    <td>111</td>
                                    <td style="font-weight: 600; color: #dc3545;">R$ 2.874,91</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="summary-section" style="grid-template-columns: repeat(3, 1fr);">
                <div class="summary-card" style="border-left-color: #ffc107;">
                    <h3> Item Mais Usado</h3>
                    <div class="value" style="color: #ffc107;">5.957 unidades</div>
                    <div class="label">Luvas de procedimento não estéril tamanho M</div>
                </div>
                
                <div class="summary-card" style="border-left-color: #dc3545;">
                    <h3> Item de Maior Custo</h3>
                    <div class="value" style="color: #dc3545;">R$ 20.151,92</div>
                    <div class="label">Cateter urinário revest hidrofílico lubrif standard masc CH10</div>
                </div>
                
                <div class="summary-card" style="border-left-color: #667eea;">
                    <h3> Custo Unitário mais alto</h3>
                    <div class="value" style="color: #667eea;">R$ 25,90</div>
                    <div class="label">Bolsa colostomia drenavel transp. recort.1 peça maxi 10-80mm</div>
                </div>
            </div>
        </div>

        <!-- Slide 8: Análise de Produtos -->
        <div class="slide" id="slide8">
            <div class="header">
                <h1> Análise de Produtos</h1>
                <p>Empréstimos Concedidos, Baixas por Validade e Estoque Parado | Janeiro - Novembro 2025</p>
            </div>
            
            <div class="content" style="grid-template-columns: 1fr;">
                <div class="section">
                    <h2> Baixa por Validade</h2>
                    <div style="overflow-x: auto; margin-bottom: 20px;">
                        <table class="table" style="font-size: 0.8em;">
                            <thead>
                                <tr>
                                    <th>Mês</th>
                                    <th>Valor</th>
                                    <th>Descrição</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="font-weight: 600;">Janeiro</td>
                                    <td style="color: #dc3545; font-weight: 600;">R$ 2.004,30</td>
                                    <td>Lenta intraocular, HIDROGEL e NEOCAÍNA</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: 600;">Fevereiro</td>
                                    <td style="color: #dc3545; font-weight: 600;">R$ 1.558,22</td>
                                    <td>Lenta intraocular e bisturi ocular</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: 600;">Março</td>
                                    <td style="color: #dc3545; font-weight: 600;">R$ 781,54</td>
                                    <td>SULFATO DE MAGNESIO e LUVA CIRURGICA COM PÓ n°8</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: 600;">Abril</td>
                                    <td style="color: #28a745; font-weight: 600;">R$ 0,00</td>
                                    <td>-</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: 600;">Maio</td>
                                    <td style="color: #dc3545; font-weight: 600;">R$ 367,46</td>
                                    <td>Lenta intraocular, ESCOVA/ESPONJA SECA e TRAMADOL</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: 600;">Junho</td>
                                    <td style="color: #28a745; font-weight: 600;">R$ 0,00</td>
                                    <td>-</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: 600;">Julho</td>
                                    <td style="color: #dc3545; font-weight: 600;">R$ 31,29</td>
                                    <td>CATETER NASAL P/OXIGENIO e FENILEFRINA 10%</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: 600;">Agosto</td>
                                    <td style="color: #dc3545; font-weight: 600;">R$ 439,74</td>
                                    <td>Lenta intraocular e ACIDO ACETICO 5%</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: 600;">Setembro</td>
                                    <td style="color: #dc3545; font-weight: 600;">R$ 506,01</td>
                                    <td>LENTE INTRAOCULAR DOBRAVEL, ACIDO ACETILSALICILICO INFANTIL, FLUORESCEINA 1% COLIRIO</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: 600;">Outubro</td>
                                    <td style="color: #dc3545; font-weight: 600;">R$ 755,84</td>
                                    <td>LENTE INTRAOCULAR DOBRAVEL E RIGIDA, DIAZEPAM 5 MG/ML - 2ML E TRAMADOL, CLOR. 50MG/ML, Bolsa de Ostomia</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: 600;">Novembro</td>
                                    <td style="color: #dc3545; font-weight: 600;">R$ 529,01</td>
                                    <td>LENTE INTRAOCULAR DOBRAVEL, CLOPIDOGREL 75MG</td>
                                </tr>
                            </tbody>
                        </table>
            </div>

                    <div class="summary-card" style="border-left-color: #dc3545; margin-top: 20px;">
                        <h3> Total Baixas por Validade</h3>
                        <div class="value" style="color: #dc3545;">R$ 6.973,81</div>
                        <div class="label">Janeiro - Novembro</div>
                </div>
                </div>
            </div>

            <div class="summary-section">
                <div class="section" style="grid-column: 1 / -1; margin-bottom: 20px;">
                    <h2> Análise do Inventário</h2>
                    <div class="table-container" style="margin-top: 20px;">
                        <table class="data-table">
                            <thead>
                                <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                    <th style="padding: 15px 20px; text-align: left; font-weight: 600; border: none; width: 30%;"></th>
                                    <th style="padding: 15px 20px; text-align: left; font-weight: 600; border: none; width: 70%;">Análise do Inventário</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="padding: 15px 20px; vertical-align: top; font-weight: 500; color: #2c3e50;">O que deu certo</td>
                                    <td style="padding: 15px 20px; vertical-align: top; color: #555;">Bipagem, contagem semanal, controle de lotes com verificação de 2 fatores, organização dos carros de paradas com itens do mesmo lote</td>
                                </tr>
                                <tr>
                                    <td style="padding: 15px 20px; vertical-align: top; font-weight: 500; color: #2c3e50;">O que precisamos melhorar</td>
                                    <td style="padding: 15px 20px; vertical-align: top; color: #555;">Endereçamento dos itens, organizar melhor o dia anterior, melhor comunicação com a enfermagem para checagem dos carrinhos de parada</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 9: Empréstimos -->
        <div class="slide" id="slide9">
            <div class="header">
                <h1>Empréstimos</h1>
            </div>
            
            <div class="content" style="grid-template-columns: 1fr 1fr;">
                <div class="section">
                    <h2>EMPRÉSTIMOS CONCEDIDOS</h2>
                    <div class="table-container" style="margin-top: 20px;">
                        <div style="overflow-x: auto;">
                            <table class="data-table" style="font-size: 0.9em;">
                                <thead>
                                    <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                        <th style="padding: 12px 15px; text-align: left; font-weight: 600; border: none;">Fornecedor</th>
                                        <th style="padding: 12px 15px; text-align: right; font-weight: 600; border: none;">Valor Total</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td style="padding: 12px 15px; color: #2c3e50;">UPAE BELO JARDIM</td>
                                        <td style="padding: 12px 15px; text-align: right; color: #555; font-weight: 500;">R$ 10.044,37</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 12px 15px; color: #2c3e50;">UPAE ARCOVERDE</td>
                                        <td style="padding: 12px 15px; text-align: right; color: #555; font-weight: 500;">R$ 4.595,58</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 12px 15px; color: #2c3e50;">UNIMED CARUARU</td>
                                        <td style="padding: 12px 15px; text-align: right; color: #555; font-weight: 500;">R$ 1.759,87</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 12px 15px; color: #2c3e50;">FUNDO MUNICIPAL DE SAÚDE</td>
                                        <td style="padding: 12px 15px; text-align: right; color: #555; font-weight: 500;">R$ 96,55</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 12px 15px; color: #2c3e50;">HOSPITAL DA MULHER DO AGRESTE</td>
                                        <td style="padding: 12px 15px; text-align: right; color: #555; font-weight: 500;">R$ 65,88</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 12px 15px; color: #2c3e50;">HOSPITAL DO TRICENTENÁRIO</td>
                                        <td style="padding: 12px 15px; text-align: right; color: #555; font-weight: 500;">R$ 105,40</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 12px 15px; color: #2c3e50;">INSTITUTO DE MEDICINA INTEGRAL</td>
                                        <td style="padding: 12px 15px; text-align: right; color: #555; font-weight: 500;">R$ 2.666,43</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 12px 15px; color: #2c3e50;">UNIDADE DE UROLOGIA DO AGRESTE</td>
                                        <td style="padding: 12px 15px; text-align: right; color: #555; font-weight: 500;">R$ 207,75</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 12px 15px; color: #2c3e50;">HSS - SOCIEDADE PERNAMBUCANA</td>
                                        <td style="padding: 12px 15px; text-align: right; color: #555; font-weight: 500;">R$ 462,22</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 12px 15px; color: #2c3e50;">HOSPITAL MEMORIAL SÃO GABRIEL</td>
                                        <td style="padding: 12px 15px; text-align: right; color: #555; font-weight: 500;">R$ 856,55</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 12px 15px; color: #2c3e50;">HOSPITAL REGIONAL DO AGRESTE</td>
                                        <td style="padding: 12px 15px; text-align: right; color: #555; font-weight: 500;">R$ 103,71</td>
                                    </tr>
                                    <tr style="background-color: #f8f9fa; border-top: 2px solid #667eea;">
                                        <td style="padding: 12px 15px; font-weight: 600; color: #2c3e50;">TOTAL GERAL CONCEDIDO:</td>
                                        <td style="padding: 12px 15px; text-align: right; font-weight: 700; color: #667eea;">R$ 20.964,31</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <h2>EMPRÉSTIMOS RECEBIDOS</h2>
                    <div class="table-container" style="margin-top: 20px;">
                        <div style="overflow-x: auto;">
                            <table class="data-table" style="font-size: 0.9em;">
                                <thead>
                                    <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                        <th style="padding: 12px 15px; text-align: left; font-weight: 600; border: none;">Fornecedor</th>
                                        <th style="padding: 12px 15px; text-align: right; font-weight: 600; border: none;">Valor Total</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td style="padding: 12px 15px; color: #2c3e50;">HOSPITAL MEMORIAL ALZIRA RIBEIRO</td>
                                        <td style="padding: 12px 15px; text-align: right; color: #555; font-weight: 500;">R$ 2.060,55</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 12px 15px; color: #2c3e50;">HOSPITAL REGIONAL DO AGRESTE</td>
                                        <td style="padding: 12px 15px; text-align: right; color: #555; font-weight: 500;">R$ 2.176,67</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 12px 15px; color: #2c3e50;">HMR - SOCIEDADE PERNAMBUCANA</td>
                                        <td style="padding: 12px 15px; text-align: right; color: #555; font-weight: 500;">R$ 1.506,04</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 12px 15px; color: #2c3e50;">HOSPITAL MEMORIAL SÃO GABRIEL</td>
                                        <td style="padding: 12px 15px; text-align: right; color: #555; font-weight: 500;">R$ 354,94</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 12px 15px; color: #2c3e50;">UNIMED CARUARU</td>
                                        <td style="padding: 12px 15px; text-align: right; color: #555; font-weight: 500;">R$ 420,40</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 12px 15px; color: #2c3e50;">HSS - SOCIEDADE PERNAMBUCANA</td>
                                        <td style="padding: 12px 15px; text-align: right; color: #555; font-weight: 500;">R$ 119,12</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 12px 15px; color: #2c3e50;">UPAE ARRUDA</td>
                                        <td style="padding: 12px 15px; text-align: right; color: #555; font-weight: 500;">R$ 13,56</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 12px 15px; color: #2c3e50;">UPAE BELO JARDIM</td>
                                        <td style="padding: 12px 15px; text-align: right; color: #555; font-weight: 500;">R$ 983,19</td>
                                    </tr>
                                    <tr style="background-color: #f8f9fa; border-top: 2px solid #667eea;">
                                        <td style="padding: 12px 15px; font-weight: 600; color: #2c3e50;">TOTAL GERAL RECEBIDO:</td>
                                        <td style="padding: 12px 15px; text-align: right; font-weight: 700; color: #667eea;">R$ 7.634,47</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div class="summary-section" style="grid-template-columns: repeat(3, 1fr); margin-top: 30px;">
                <div class="summary-card" style="border-left-color: #dc3545;">
                    <h3>Total Concedido</h3>
                    <div class="value" style="color: #dc3545;">R$ 20.964,31</div>
                </div>
                
                <div class="summary-card" style="border-left-color: #28a745;">
                    <h3>Total Recebido</h3>
                    <div class="value" style="color: #28a745;">R$ 7.634,47</div>
                </div>
                
                <div class="summary-card" style="border-left-color: #667eea;">
                    <h3>Saldo Líquido</h3>
                    <div class="value" style="color: #667eea;"> - R$ 13.329,84</div>
                    <div class="label">Concedido - Recebido</div>
                </div>
            </div>
        </div>

        <!-- Slide 10: Neuropediatria -->
        <div class="slide" id="slide10">
            <div class="header">
                <h1>Neuropediatria</h1>
            </div>
            
            <div class="content" style="grid-template-columns: 1fr 1fr 1fr;">
                <div class="section">
                    <h2>Fonoaudiologia</h2>
                    <div class="chart-container">
                        <canvas id="fonoaudiologiaChart"></canvas>
                    </div>
                </div>
                
                <div class="section">
                    <h2>Fono exames</h2>
                    <div class="chart-container">
                        <canvas id="fonoExamesChart"></canvas>
                    </div>
                </div>
                
                <div class="section">
                    <h2>Terapia Ocupacional</h2>
                    <div class="chart-container">
                        <canvas id="terapiaOcupacionalChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="content" style="grid-template-columns: 1fr 1fr; margin-top: 20px;">
                <div class="section">
                    <h2> Ação</h2>
                    <div class="table-container" style="margin-top: 20px;">
                        <table class="data-table">
                            <thead>
                                <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                    <th style="padding: 15px 20px; text-align: left; font-weight: 600; border: none;">Ação</th>
                                    <th style="padding: 15px 20px; text-align: left; font-weight: 600; border: none;">Descrição</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 30%; font-weight: 500; color: #2c3e50;">Neuropediatra</td>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 70%; color: #555;">Adequação da Sala Multidisciplinar em fases finais</td>
                                </tr>
                                <tr>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 30%; font-weight: 500; color: #2c3e50;">Neuropediatra</td>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 70%; color: #555;">Ajuste do local de espera das crianças coma manutenção e a TI</td>
                                </tr>
                                <tr>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 30%; font-weight: 500; color: #2c3e50;">Neuropediatra</td>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 70%; color: #555;">Possibilidade de voluntários para recreação com as crianças (o HCP tem alguma ação para isso?)</td>
                                </tr>
                                <tr>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 30%; font-weight: 500; color: #2c3e50;">Altas</td>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 70%; color: #555;">Outubro 20 / Novembro 5</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            
            <div class="section">
                    <h2>Projeto Neurodivergentes</h2>
                <div class="chart-container">
                        <canvas id="projetoNeurodivergentesChart"></canvas>
                </div>
            </div>
                </div>
                </div>
                
        <!-- Slide 11: Cronogramas e Atividades -->
        <div class="slide" id="slide11">
            <div class="header">
                <h1> Cronogramas e Atividades</h1>
            </div>
            
            <div class="content" style="grid-template-columns: 1fr;">
                <div class="section">
                    <h2> Ações</h2>
                    <div class="table-container" style="margin-top: 30px;">
                        <table class="data-table">
                            <thead>
                                <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                    <th style="padding: 15px 20px; text-align: left; font-weight: 600; border: none;">Ações Futuras</th>
                                    <th style="padding: 15px 20px; text-align: left; font-weight: 600; border: none;">STATUS</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 40%; font-weight: 500; color: #2c3e50;">Padronização da chamada da TI</td>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 60%; color: #555;">Não conseguimos fixar a chamada pois a versão é diferente, não consguimos implantar na UPAE Caruaru</td>
                                </tr>
                                <tr>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 40%; font-weight: 500; color: #2c3e50;">Emenda</td>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 60%; color: #555;">Lentes de catarata  e Hemoclip</td>
                                </tr>
                                <tr>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 40%; font-weight: 500; color: #2c3e50;">Endereçamento Farmacia e Almoxarifado</td>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 60%; color: #555;">jan.-26</td>
                                </tr>
                                <tr>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 40%; font-weight: 500; color: #2c3e50;">OCI</td>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 60%; color: #555;">Realizamos 18 OCI's e 10 já foram concluidas.</td>
                                </tr>
                                <tr>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 40%; font-weight: 500; color: #2c3e50;">FISPQ</td>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 60%; color: #555;">A Segurança do Trabalho está entrando em contato com as empresas para solicitar a informação. Caso não obtenha retorno, o item será definido como pré-requisito para o fornecimento.</td>
                                </tr>
                                <tr>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 40%; font-weight: 500; color: #2c3e50;">Fracionamento</td>
                                    <td style="padding: 15px 20px; vertical-align: top; width: 60%; color: #555;">Controle do fracionamento dos inflamáveis no setor</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="section" style="margin-top: 40px;">
                    <h2> AÇÕES PARA 2026</h2>
                    <div class="table-container" style="margin-top: 30px;">
                        <div style="overflow-x: auto;">
                            <table class="table" style="font-size: 0.85em;">
                                <thead>
                                    <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                        <th style="padding: 12px 15px; text-align: left; font-weight: 600; border: none; width: 5%;"></th>
                                        <th style="padding: 12px 15px; text-align: left; font-weight: 600; border: none; width: 25%;">AÇÕES PARA 2026</th>
                                        <th style="padding: 12px 15px; text-align: left; font-weight: 600; border: none; width: 70%;">AÇÃO</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="expandable-row" style="cursor: pointer; background-color: #f8f9fa;">
                                        <td style="text-align: center; font-weight: bold; padding: 15px;">+</td>
                                        <td style="font-weight: 600; padding: 15px; color: #2c3e50;">Janeiro Branco</td>
                                        <td style="padding: 15px; color: #555;">Bingo do autocuidado dia 20/01</td>
                                    </tr>
                                    <tr class="detail-row" style="display: none;">
                                        <td colspan="3" style="padding: 15px; background-color: #ffffff; border-top: 2px solid #667eea;">
                                            <table style="width: 100%; font-size: 0.9em;">
                                                <tr>
                                                    <td style="padding: 8px; font-weight: 600; color: #667eea; width: 20%;">PSICOLOGIA:</td>
                                                    <td style="padding: 8px; color: #555;">Roda de conversa com colaboradores.</td>
                                                </tr>
                                                <tr>
                                                    <td style="padding: 8px; font-weight: 600; color: #667eea; width: 20%;">SERVIÇO SOCIAL:</td>
                                                    <td style="padding: 8px; color: #555;">Fala sobre acolhimento – "Cuidar de quem cuida"</td>
                                                </tr>
                                                <tr>
                                                    <td style="padding: 8px; font-weight: 600; color: #667eea; width: 20%;">NUTRIÇÃO:</td>
                                                    <td style="padding: 8px; color: #555;">Dicas de alimentação para controle da ansiedade.</td>
                                                </tr>
                                                <tr>
                                                    <td style="padding: 8px; font-weight: 600; color: #667eea; width: 20%;">FARMÁCIA:</td>
                                                    <td style="padding: 8px; color: #555;">Materiais sobre uso seguro de medicamentos para saúde mental.</td>
                                                </tr>
                                                <tr>
                                                    <td style="padding: 8px; font-weight: 600; color: #667eea; width: 20%;">FISIOTERAPIA:</td>
                                                    <td style="padding: 8px; color: #555;">Alongamentos e exercícios de respiração para relaxamento.</td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    <tr class="expandable-row" style="cursor: pointer;">
                                        <td style="text-align: center; font-weight: bold; padding: 15px;">+</td>
                                        <td style="font-weight: 600; padding: 15px; color: #2c3e50;">Fevereiro – Carnaval / Prevenção de Acidentes</td>
                                        <td style="padding: 15px; color: #555;">Ações de prevenção no dia 10/02 mas durante o mês também poderão ser abordadas outras temáticas: Alzheimer, Fibromialgia e Lúpus.</td>
                                    </tr>
                                    <tr class="detail-row" style="display: none;">
                                        <td colspan="3" style="padding: 15px; background-color: #ffffff; border-top: 2px solid #667eea;">
                                            <table style="width: 100%; font-size: 0.9em;">
                                                <tr>
                                                    <td style="padding: 8px; font-weight: 600; color: #667eea; width: 20%;">PSICOLOGIA:</td>
                                                    <td style="padding: 8px; color: #555;">Limites saudáveis e prevenção de abuso.</td>
                                                </tr>
                                                <tr>
                                                    <td style="padding: 8px; font-weight: 600; color: #667eea; width: 20%;">SERVIÇO SOCIAL:</td>
                                                    <td style="padding: 8px; color: #555;">Prevenção da violência e vulnerabilidades sociais.</td>
                                                </tr>
                                                <tr>
                                                    <td style="padding: 8px; font-weight: 600; color: #667eea; width: 20%;">NUTRIÇÃO:</td>
                                                    <td style="padding: 8px; color: #555;">Hidratação e cuidados com a alimentação.</td>
                                                </tr>
                                                <tr>
                                                    <td style="padding: 8px; font-weight: 600; color: #667eea; width: 20%;">FARMÁCIA:</td>
                                                    <td style="padding: 8px; color: #555;">Uso responsável de álcool e interações medicamentosas.</td>
                                                </tr>
                                                <tr>
                                                    <td style="padding: 8px; font-weight: 600; color: #667eea; width: 20%;">FISIOTERAPIA:</td>
                                                    <td style="padding: 8px; color: #555;">Prevenção de lesões de coluna e membros.</td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    <tr class="expandable-row" style="cursor: pointer; background-color: #f8f9fa;">
                                        <td style="text-align: center; font-weight: bold; padding: 15px;">+</td>
                                        <td style="font-weight: 600; padding: 15px; color: #2c3e50;">Março Azul-Marinho</td>
                                        <td style="padding: 15px; color: #555;">Ações de prevenção no dia 17/03 e mutirão de colonoscopia</td>
                                    </tr>
                                    <tr class="detail-row" style="display: none;">
                                        <td colspan="3" style="padding: 15px; background-color: #ffffff; border-top: 2px solid #667eea;">
                                            <table style="width: 100%; font-size: 0.9em;">
                                                <tr>
                                                    <td style="padding: 8px; font-weight: 600; color: #667eea; width: 20%;">PSICOLOGIA:</td>
                                                    <td style="padding: 8px; color: #555;">Rodas de conversa sobre medo do diagnóstico, estigma e adesão ao rastreamento.</td>
                                                </tr>
                                                <tr>
                                                    <td style="padding: 8px; font-weight: 600; color: #667eea; width: 20%;">SERVIÇO SOCIAL:</td>
                                                    <td style="padding: 8px; color: #555;">Direitos do paciente oncológico (auxílio-doença, BPC, TFD).</td>
                                                </tr>
                                                <tr>
                                                    <td style="padding: 8px; font-weight: 600; color: #667eea; width: 20%;">NUTRIÇÃO:</td>
                                                    <td style="padding: 8px; color: #555;">Alimentação rica em fibras e prevenção do câncer colorretal.</td>
                                                </tr>
                                                <tr>
                                                    <td style="padding: 8px; font-weight: 600; color: #667eea; width: 20%;">FARMÁCIA:</td>
                                                    <td style="padding: 8px; color: #555;">Riscos da automedicação para o trato gastrointestinal.</td>
                                                </tr>
                                                <tr>
                                                    <td style="padding: 8px; font-weight: 600; color: #667eea; width: 20%;">FISIOTERAPIA:</td>
                                                    <td style="padding: 8px; color: #555;">Atividade física como fator protetor.</td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    <tr class="expandable-row" style="cursor: pointer;">
                                        <td style="text-align: center; font-weight: bold; padding: 15px;">+</td>
                                        <td style="font-weight: 600; padding: 15px; color: #2c3e50;">Abril – Mês de Alusão ao TEA</td>
                                        <td style="padding: 15px; color: #555;">Ações em alusão ao TEA para os pacientes dia 14/04 e para colaboradores 24/04</td>
                                    </tr>
                                    <tr class="detail-row" style="display: none;">
                                        <td colspan="3" style="padding: 15px; background-color: #ffffff; border-top: 2px solid #667eea;">
                                            <table style="width: 100%; font-size: 0.9em;">
                                                <tr>
                                                    <td style="padding: 8px; font-weight: 600; color: #667eea; width: 20%;">PSICOLOGIA:</td>
                                                    <td style="padding: 8px; color: #555;">Acolhimento de pacientes com TEA no ambiente hospitalar.</td>
                                                </tr>
                                                <tr>
                                                    <td style="padding: 8px; font-weight: 600; color: #667eea; width: 20%;">SERVIÇO SOCIAL:</td>
                                                    <td style="padding: 8px; color: #555;">Orientação às famílias sobre os direitos da pessoa com TEA.</td>
                                                </tr>
                                                <tr>
                                                    <td style="padding: 8px; font-weight: 600; color: #667eea; width: 20%;">NUTRIÇÃO:</td>
                                                    <td style="padding: 8px; color: #555;">Alimentação seletiva no TEA,como entender e acolher.</td>
                                                </tr>
                                                <tr>
                                                    <td style="padding: 8px; font-weight: 600; color: #667eea; width: 20%;">FARMÁCIA:</td>
                                                    <td style="padding: 8px; color: #555;">Riscos da automedicação em pacientes com TEA.</td>
                                                </tr>
                                                <tr>
                                                    <td style="padding: 8px; font-weight: 600; color: #667eea; width: 20%;">FISIOTERAPIA:</td>
                                                    <td style="padding: 8px; color: #555;">Estratégias motoras e sensoriais para redução da ansiedade.</td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div style="margin-top: 40px; display: flex; justify-content: center; align-items: center;">
                        <img id="controleImage" src="public/controle.jpeg" alt="Controle de Uso do Formaldeído" class="clickable-image" style="max-width: 100%; max-height: 500px; object-fit: contain; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 12: Imagem HCP -->
        <div class="slide" id="slide12">
            <div class="header">
                <h1>HCP</h1>
            </div>
            
            <div class="content" style="display: flex; justify-content: center; align-items: center; height: 100%;">
                <img src="public/HCP.png" alt="HCP Logo" style="max-width: 60%; max-height: 60%; object-fit: contain;">
            </div>
        </div>

    </div>

    </div>

    <!-- Navegação -->
    <div class="navigation">
        <button class="nav-btn" id="prevBtn" onclick="changeSlide(-1)">← Anterior</button>
        <div class="slide-counter">
            <span id="currentSlide">1</span> / <span id="totalSlides">12</span>
        </div>
        <div class="slide-dots" id="slideDots"></div>
        <button class="nav-btn" id="nextBtn" onclick="changeSlide(1)">Próximo →</button>
    </div>

    <script>
        let currentSlideIndex = 0;
        const totalSlides = 12;


        function showSlide(index) {
            const slides = document.querySelectorAll('.slide');
            slides.forEach(slide => slide.classList.remove('active'));
            slides[index].classList.add('active');
            
            document.getElementById('currentSlide').textContent = index + 1;
            
            // Atualizar dots
            const dots = document.querySelectorAll('.dot');
            dots.forEach((dot, i) => {
                dot.classList.toggle('active', i === index);
            });
            
            // Atualizar botões
            document.getElementById('prevBtn').disabled = index === 0;
            document.getElementById('nextBtn').disabled = index === totalSlides - 1;
            
            // Forçar reflow antes de inicializar os gráficos
            // Isso garante que display:block foi aplicado e elementos têm dimensões
            slides[index].offsetHeight; // Force reflow
            
            // Aguardar para garantir que o CSS foi aplicado e elementos têm dimensões
            setTimeout(() => {
            initializeSlideCharts(index);
            }, 150);
        }

        function changeSlide(direction) {
            const newIndex = currentSlideIndex + direction;
            if (newIndex >= 0 && newIndex < totalSlides) {
                currentSlideIndex = newIndex;
                showSlide(currentSlideIndex);
            }
        }
        
        function goToSlide(index) {
            currentSlideIndex = index;
            showSlide(currentSlideIndex);
        }

        // Criar dots de navegação
        function createDots() {
            const dotsContainer = document.getElementById('slideDots');
            for (let i = 0; i < totalSlides; i++) {
                const dot = document.createElement('div');
                dot.className = 'dot';
                if (i === 0) dot.classList.add('active');
                dot.onclick = () => goToSlide(i);
                dotsContainer.appendChild(dot);
            }
        }

        // Navegação por teclado
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') changeSlide(-1);
            if (e.key === 'ArrowRight') changeSlide(1);
        });

        // Inicializar
        document.addEventListener('DOMContentLoaded', function() {
            createDots();
            showSlide(0);
            
            // Funcionalidade de expansão das linhas da tabela de custos de cirurgias
            const expandableRows = document.querySelectorAll('.expandable-row');
            expandableRows.forEach(row => {
                row.addEventListener('click', function() {
                    const detailRow = this.nextElementSibling;
                    if (detailRow && detailRow.classList.contains('detail-row')) {
                        const isExpanded = detailRow.style.display !== 'none';
                        detailRow.style.display = isExpanded ? 'none' : 'table-row';
                        const plusSign = this.querySelector('td:first-child');
                        plusSign.textContent = isExpanded ? '+' : '−';
                    }
                });
            });
        });

        // Inicializar gráficos do slide específico
        // Dados para slide 12 - Valor por Espécie
        const especieData = {
            labels: ['Material Descartável/Penso', 'OPME', 'Outras Despesas', 'Medicamentos'],
            data: [3385.33, 7265.18, 3388.08, 726.83],
            backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0']
        };


        function initializeSlideCharts(slideIndex) {
            // Inicializar gráficos baseado no slide atual
            if (slideIndex === 0) { // Slide 1: Calendário (sem gráficos)
                return;
            }
            
            if (slideIndex === 1) { // Slide 2: Desempenho Mensal - Executado vs Meta
                // Gráfico de Consultas
                const consultasCtx = document.getElementById('consultasChart');
                if (consultasCtx) {
                    // Destruir gráfico existente se houver
                    if (window.consultasChartInstance) {
                        window.consultasChartInstance.destroy();
                    }
                    
                    window.consultasChartInstance = new Chart(consultasCtx, {
                    type: 'line',
                    data: {
                        labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov'],
                        datasets: [{
                            label: 'Realizado',
                            data: [3299, 3299, 3299, 2703, 2501, 2427, 2376, 2297, 2242, 2651, 2105],
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            borderColor: 'rgba(102, 126, 234, 1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        }, {
                            label: 'Meta',
                            data: [3157, 3157, 3157, 2070, 2070, 2070, 2070, 2070, 2070, 2070, 2070],
                            backgroundColor: 'rgba(255, 99, 132, 0.1)',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'top' }
                        }
                    }
                });
                }

                // Gráfico de Sessões
                const sessoesCtx = document.getElementById('sessoesChart');
                if (sessoesCtx) {
                    // Destruir gráfico existente se houver
                    if (window.sessoesChartInstance) {
                        window.sessoesChartInstance.destroy();
                    }
                    
                    window.sessoesChartInstance = new Chart(sessoesCtx, {
                    type: 'line',
                    data: {
                        labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov'],
                        datasets: [{
                            label: 'Realizado',
                            data: [2673, 2673, 2673, 2314, 1712, 1530, 1729, 1506, 1636, 1381, 1431],
                            backgroundColor: 'rgba(54, 162, 235, 0.1)',
                            borderColor: 'rgba(54, 162, 235, 1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        }, {
                            label: 'Meta',
                            data: [2518, 2518, 2518, 1602, 1602, 1602, 1602, 1602, 1602, 1602, 1602],
                            backgroundColor: 'rgba(255, 159, 64, 0.1)',
                            borderColor: 'rgba(255, 159, 64, 1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'top' }
                        }
                    }
                });
                }
            }
            
            if (slideIndex === 2) { // Slide 3: Altas/Inclusões
                // Gráfico de Altas das Sessões
                const altasSessoesCtx = document.getElementById('altasSessoesChart');
                if (altasSessoesCtx) {
                    // Destruir gráfico existente se houver
                    if (window.altasSessoesChartInstance) {
                        window.altasSessoesChartInstance.destroy();
                    }
                    
                    window.altasSessoesChartInstance = new Chart(altasSessoesCtx, {
                        type: 'bar',
                    data: {
                            labels: ['Agosto', 'Setembro', 'Outubro', 'Novembro'],
                        datasets: [{
                                label: 'Fisioterapia',
                                data: [23, 21, 25, 19],
                                backgroundColor: 'rgba(54, 162, 235, 0.8)',
                                borderColor: 'rgba(54, 162, 235, 1)',
                                borderWidth: 2
                            }, {
                                label: 'Fonoaudiologia',
                                data: [8, 10, 12, 20],
                                backgroundColor: 'rgba(255, 99, 132, 0.8)',
                                borderColor: 'rgba(255, 99, 132, 1)',
                                borderWidth: 2
                            }, {
                                label: 'Psicologia',
                                data: [52, 55, 46, 49],
                                backgroundColor: 'rgba(255, 206, 86, 0.8)',
                                borderColor: 'rgba(255, 206, 86, 1)',
                                borderWidth: 2
                            }, {
                                label: 'Terapia Ocupacional',
                                data: [2, 2, 5, 3],
                                backgroundColor: 'rgba(75, 192, 192, 0.8)',
                                borderColor: 'rgba(75, 192, 192, 1)',
                                borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                            layout: {
                                padding: {
                                    top: 50
                                }
                            },
                        plugins: {
                            legend: { 
                                    position: 'top',
                                    padding: {
                                        bottom: 30
                                    }
                                },
                                title: {
                                    display: true,
                                    text: 'Altas das Sessões'
                                },
                            tooltip: {
                                    enabled: true
                                },
                                datalabels: {
                                    anchor: 'end',
                                    align: 'top',
                                    formatter: function(value) {
                                        return value;
                                    },
                                    font: {
                                        weight: 'bold',
                                        size: 12
                                    },
                                    color: '#333'
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    ticks: {
                                        stepSize: 5
                                    }
                                }
                            }
                        },
                        plugins: [{
                            id: 'datalabels',
                            afterDatasetsDraw: (chart) => {
                                const ctx = chart.ctx;
                                chart.data.datasets.forEach((dataset, i) => {
                                    const meta = chart.getDatasetMeta(i);
                                    meta.data.forEach((bar, index) => {
                                        const data = dataset.data[index];
                                        const barHeight = bar.base - bar.y;
                                        if (barHeight > 0) {
                                            ctx.save();
                                            ctx.fillStyle = '#000';
                                            ctx.font = 'bold 12px Arial';
                                            ctx.textAlign = 'center';
                                            ctx.textBaseline = 'middle';
                                            const centerY = bar.y + (barHeight / 2);
                                            ctx.fillText(data, bar.x, centerY);
                                            ctx.restore();
                                        }
                                    });
                                });
                            }
                        }]
                    });
                }

                // Gráfico de Inclusões no projeto de Glaucoma
                const inclusoesGlaucomaCtx = document.getElementById('inclusoesGlaucomaChart');
                if (inclusoesGlaucomaCtx) {
                    // Destruir gráfico existente se houver
                    if (window.inclusoesGlaucomaChartInstance) {
                        window.inclusoesGlaucomaChartInstance.destroy();
                    }
                    
                    window.inclusoesGlaucomaChartInstance = new Chart(inclusoesGlaucomaCtx, {
                        type: 'bar',
                        data: {
                            labels: ['Agosto', 'Setembro', 'Outubro', 'Novembro'],
                            datasets: [{
                                label: 'Farmácia',
                                data: [41, 59, 20, 15],
                                backgroundColor: 'rgba(153, 102, 255, 0.8)',
                                borderColor: 'rgba(153, 102, 255, 1)',
                                borderWidth: 2
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            layout: {
                                padding: {
                                    top: 50
                                }
                            },
                            plugins: {
                                legend: { 
                                    position: 'top',
                                    padding: {
                                        bottom: 30
                                    }
                                },
                                title: {
                                    display: true,
                                    text: 'Inclusões no projeto de Glaucoma'
                                },
                                tooltip: {
                                    enabled: true
                                },
                                datalabels: {
                                    anchor: 'end',
                                    align: 'top',
                                    formatter: function(value) {
                                        return value;
                                    },
                                    font: {
                                        weight: 'bold',
                                        size: 12
                                    },
                                    color: '#333'
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    ticks: {
                                        stepSize: 5
                                    }
                                }
                            }
                        },
                        plugins: [{
                            id: 'datalabels',
                            afterDatasetsDraw: (chart) => {
                                const ctx = chart.ctx;
                                chart.data.datasets.forEach((dataset, i) => {
                                    const meta = chart.getDatasetMeta(i);
                                    meta.data.forEach((bar, index) => {
                                        const data = dataset.data[index];
                                        const barHeight = bar.base - bar.y;
                                        if (barHeight > 0) {
                                            ctx.save();
                                            ctx.fillStyle = '#000';
                                            ctx.font = 'bold 12px Arial';
                                            ctx.textAlign = 'center';
                                            ctx.textBaseline = 'middle';
                                            const centerY = bar.y + (barHeight / 2);
                                            ctx.fillText(data, bar.x, centerY);
                                            ctx.restore();
                                        }
                                    });
                                });
                            }
                        }]
                    });
                }
            }
            
            if (slideIndex === 3) { // Slide 4: Nutrição
                const nutricaoAlmocoCtx = document.getElementById('nutricaoAlmocoChart');
                if (nutricaoAlmocoCtx) {
                    // Destruir gráfico existente se houver
                    if (window.nutricaoAlmocoChartInstance) {
                        window.nutricaoAlmocoChartInstance.destroy();
                    }
                    
                    window.nutricaoAlmocoChartInstance = new Chart(nutricaoAlmocoCtx, {
                        type: 'line',
                        data: {
                            labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov'],
                            datasets: [{
                                label: 'Gastos com Almoço (R$)',
                                data: [34793.10, 35041.20, 29790.50, 36339.00, 38854.00, 32886.80, 41329.70, 35611.90, 34493.10, 37767.00, 30041.30],
                                borderColor: '#FF6384',
                                backgroundColor: 'rgba(255, 99, 132, 0.1)',
                                borderWidth: 3,
                                fill: true,
                                tension: 0.4
                            }, {
                                label: 'Teto',
                                data: [32120, 32120, 32120, 32120, 32120, 32120, 32120, 32120, 32120, 32120, 32120],
                                borderColor: '#999',
                                backgroundColor: 'transparent',
                                borderWidth: 2,
                                borderDash: [5, 5],
                                fill: false,
                                pointRadius: 0,
                                pointHoverRadius: 5,
                                pointHoverBackgroundColor: '#999',
                                pointHoverBorderColor: '#999',
                                tension: 0
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            interaction: {
                                intersect: false,
                                mode: 'index'
                            },
                            plugins: {
                                legend: { position: 'top' },
                                tooltip: {
                                    intersect: false,
                                    mode: 'index',
                                    callbacks: {
                                        label: function(context) {
                                            let label = context.dataset.label || '';
                                            if (label) {
                                                label += ': ';
                                            }
                                            if (context.parsed.y !== null) {
                                                label += new Intl.NumberFormat('pt-BR', {
                                                    style: 'currency',
                                                    currency: 'BRL'
                                                }).format(context.parsed.y);
                                            }
                                            return label;
                                        }
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true
                                }
                            }
                        }
                    });
                }
                
                const nutricaoDesperdicioCtx = document.getElementById('nutricaoDesperdicioChart');
                if (nutricaoDesperdicioCtx) {
                    // Destruir gráfico existente se houver
                    if (window.nutricaoDesperdicioChartInstance) {
                        window.nutricaoDesperdicioChartInstance.destroy();
                    }
                    
                    window.nutricaoDesperdicioChartInstance = new Chart(nutricaoDesperdicioCtx, {
                        type: 'bar',
                        data: {
                            labels: ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro'],
                            datasets: [{
                                label: 'Desperdiçometro (KG)',
                                data: [84.8, 75.3, 58.7, 77.1, 76.1, 71.7, 87.3, 88.2, 75.8, 97.7, 82.1],
                                backgroundColor: [
                                    'rgba(255, 99, 132, 0.8)', // Vermelho
                                    'rgba(54, 162, 235, 0.8)', // Azul
                                    'rgba(255, 206, 86, 0.8)', // Amarelo
                                    'rgba(75, 192, 192, 0.8)', // Verde-azulado
                                    'rgba(153, 102, 255, 0.8)', // Roxo
                                    'rgba(255, 159, 64, 0.8)', // Laranja
                                    'rgba(199, 199, 199, 0.8)', // Cinza
                                    'rgba(83, 102, 255, 0.8)',  // Azul escuro
                                    'rgba(255, 99, 132, 0.8)', // Vermelho (Setembro)
                                    'rgba(54, 162, 235, 0.8)',  // Azul (Outubro)
                                    'rgba(75, 192, 192, 0.8)'  // Verde-azulado (Novembro)
                                ],
                                borderWidth: 2,
                                borderColor: '#fff'
                            }, {
                                label: 'Faixa Mínima Normal',
                                data: [36.23, 36.23, 36.23, 36.23, 36.23, 36.23, 36.23, 36.23, 36.23, 36.23, 36.23],
                                type: 'line',
                                borderColor: 'rgba(54, 162, 235, 1)',
                                backgroundColor: 'rgba(54, 162, 235, 0.1)',
                                borderWidth: 2,
                                borderDash: [5, 5],
                                fill: false,
                                pointRadius: 0,
                                pointHoverRadius: 0
                            }, {
                                label: 'Faixa Máxima Normal',
                                data: [108.68, 108.68, 108.68, 108.68, 108.68, 108.68, 108.68, 108.68, 108.68, 108.68, 108.68],
                                type: 'line',
                                borderColor: 'rgba(255, 99, 132, 1)',
                                backgroundColor: 'rgba(255, 99, 132, 0.1)',
                                borderWidth: 2,
                                borderDash: [5, 5],
                                fill: false,
                                pointRadius: 0,
                                pointHoverRadius: 0
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { position: 'top' }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    title: {
                                        display: true,
                                        text: 'Quilogramas (KG)'
                                    }
                                },
                                x: {
                                    title: {
                                        display: true,
                                        text: 'Meses'
                                    }
                                }
                            }
                        }
                    });
                }

                // Gráfico de Nutrição Insumos
                const nutricaoInsumosCtx = document.getElementById('nutricaoInsumosChart');
                if (nutricaoInsumosCtx) {
                    // Destruir gráfico existente se houver
                    if (window.nutricaoInsumosChartInstance) {
                        window.nutricaoInsumosChartInstance.destroy();
                    }
                    
                    window.nutricaoInsumosChartInstance = new Chart(nutricaoInsumosCtx, {
                        type: 'line',
                        data: {
                            labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov'],
                            datasets: [{
                                label: 'Nutrição Insumos',
                                data: [1707.20, 636.30, 1215.45, 760.02, 1732.81, 995.78, 725.01, 1166.30, 1493.11, 1476.02, 825.14],
                                borderColor: 'rgba(102, 126, 234, 1)',
                                backgroundColor: 'rgba(102, 126, 234, 0.1)',
                                borderWidth: 3,
                                fill: true,
                                tension: 0.4,
                                pointBackgroundColor: 'rgba(102, 126, 234, 1)',
                                pointBorderColor: '#fff',
                                pointBorderWidth: 2,
                                pointRadius: 5,
                                pointHoverRadius: 7
                            }, {
                                label: 'Teto',
                                data: [1200.00, 1200.00, 1200.00, 1200.00, 1200.00, 1200.00, 1200.00, 1200.00, 1200.00, 1200.00, 1200.00],
                                borderColor: 'rgba(255, 99, 132, 1)',
                                backgroundColor: 'rgba(255, 99, 132, 0.1)',
                                borderWidth: 2,
                                borderDash: [5, 5],
                                fill: false,
                                pointRadius: 0,
                                pointHoverRadius: 5,
                                pointHoverBackgroundColor: 'rgba(255, 99, 132, 1)',
                                pointHoverBorderColor: 'rgba(255, 99, 132, 1)'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            interaction: {
                                intersect: false,
                                mode: 'index'
                            },
                            plugins: {
                                legend: { position: 'top' },
                                tooltip: {
                                    intersect: false,
                                    mode: 'index',
                                    callbacks: {
                                        label: function(context) {
                                            let label = context.dataset.label || '';
                                            if (label) {
                                                label += ': ';
                                            }
                                            if (context.parsed.y !== null) {
                                                label += new Intl.NumberFormat('pt-BR', {
                                                    style: 'currency',
                                                    currency: 'BRL'
                                                }).format(context.parsed.y);
                                            }
                                            return label;
                                        }
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    ticks: {
                                        callback: function(value) {
                                            return 'R$ ' + value.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                                        }
                                    },
                                    title: {
                                        display: true,
                                        text: 'Valor (R$)'
                                    }
                                },
                                x: {
                                    title: {
                                        display: true,
                                        text: 'Meses'
                                    }
                                }
                            }
                        }
                    });
                }
                return;
            }
            
            if (slideIndex === 4) { // Slide 5: Radiologia
                const radiologiaInsumosCtx = document.getElementById('radiologiaInsumosChart');
                if (radiologiaInsumosCtx) {
                    // Destruir gráfico existente se houver
                    if (window.radiologiaInsumosChartInstance) {
                        window.radiologiaInsumosChartInstance.destroy();
                    }
                    
                    window.radiologiaInsumosChartInstance = new Chart(radiologiaInsumosCtx, {
                        type: 'line',
                    data: {
                            labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov'],
                        datasets: [{
                                label: 'Radiologia Insumos',
                                data: [1343.46, 891.69, 1471.63, 1493.47, 743.77, 1434.42, 1816.00, 1853.25, 1593.20, 3250.40, 862.61],
                            borderColor: 'rgba(102, 126, 234, 1)',
                                backgroundColor: 'rgba(102, 126, 234, 0.1)',
                                borderWidth: 3,
                                fill: true,
                                tension: 0.4,
                                pointBackgroundColor: 'rgba(102, 126, 234, 1)',
                                pointBorderColor: '#fff',
                                pointBorderWidth: 2,
                                pointRadius: 5,
                                pointHoverRadius: 7
                            }, {
                                label: 'Teto (80 exames)',
                                data: [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500],
                            borderColor: 'rgba(255, 99, 132, 1)',
                            backgroundColor: 'rgba(255, 99, 132, 0.1)',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            fill: false,
                            pointRadius: 0,
                                pointHoverRadius: 5,
                                pointHoverBackgroundColor: 'rgba(255, 99, 132, 1)',
                                pointHoverBorderColor: 'rgba(255, 99, 132, 1)'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                            interaction: {
                                intersect: false,
                                mode: 'index'
                            },
                            plugins: {
                                legend: { position: 'top' },
                            tooltip: {
                                    intersect: false,
                                    mode: 'index',
                                callbacks: {
                                    label: function(context) {
                                            let label = context.dataset.label || '';
                                            if (label) {
                                                label += ': ';
                                            }
                                            if (context.parsed.y !== null) {
                                                label += new Intl.NumberFormat('pt-BR', {
                                                    style: 'currency',
                                                    currency: 'BRL'
                                                }).format(context.parsed.y);
                                            }
                                            return label;
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                            return 'R$ ' + value.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                                        }
                                    },
                                    title: {
                                        display: true,
                                        text: 'Valor (R$)'
                                    }
                                },
                                x: {
                                    title: {
                                        display: true,
                                        text: 'Meses'
                                    }
                            }
                        }
                    }
                });
                }
                
                return;
            }
            
            if (slideIndex === 9) { // Slide 10: Neuropediatria
                // Gráfico Fonoaudiologia
                const fonoaudiologiaCtx = document.getElementById('fonoaudiologiaChart');
                if (fonoaudiologiaCtx) {
                    // Destruir gráfico existente se houver
                    if (window.fonoaudiologiaChartInstance) {
                        window.fonoaudiologiaChartInstance.destroy();
                    }
                    
                    window.fonoaudiologiaChartInstance = new Chart(fonoaudiologiaCtx, {
                        type: 'line',
                        data: {
                            labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov'],
                            datasets: [{
                                label: 'Fonoaudiologia',
                                data: [null, 1800.00, 1110.00, 480.00, 1890.00, 1990.00, 1760.00, 2180.00, 4540.00, 6000.00, 5550.00],
                                borderColor: 'rgba(102, 126, 234, 1)',
                                backgroundColor: 'rgba(102, 126, 234, 0.1)',
                                borderWidth: 3,
                                fill: true,
                                tension: 0.4,
                                pointBackgroundColor: 'rgba(102, 126, 234, 1)',
                                pointBorderColor: '#fff',
                                pointBorderWidth: 2,
                                pointRadius: 5,
                                pointHoverRadius: 7
                            }, {
                                label: 'Teto',
                                data: [6000.00, 6000.00, 6000.00, 6000.00, 6000.00, 6000.00, 6000.00, 6000.00, 6000.00, 6000.00, 6000.00],
                                borderColor: 'rgba(255, 99, 132, 1)',
                                backgroundColor: 'rgba(255, 99, 132, 0.1)',
                                borderWidth: 2,
                                borderDash: [5, 5],
                                fill: false,
                                pointRadius: 0,
                                pointHoverRadius: 5,
                                pointHoverBackgroundColor: 'rgba(255, 99, 132, 1)',
                                pointHoverBorderColor: 'rgba(255, 99, 132, 1)'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            interaction: {
                                intersect: false,
                                mode: 'index'
                            },
                            plugins: {
                                legend: { position: 'top' },
                                tooltip: {
                                    intersect: false,
                                    mode: 'index',
                                    callbacks: {
                                        label: function(context) {
                                            let label = context.dataset.label || '';
                                            if (label) {
                                                label += ': ';
                                            }
                                            if (context.parsed.y !== null) {
                                                label += new Intl.NumberFormat('pt-BR', {
                                                    style: 'currency',
                                                    currency: 'BRL'
                                                }).format(context.parsed.y);
                                            }
                                            return label;
                                        }
                                    }
                                }
                        },
                        scales: {
                            y: {
                                    beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                            return 'R$ ' + value.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                                        }
                                    },
                                    title: {
                                        display: true,
                                        text: 'Valor (R$)'
                                    }
                                },
                                x: {
                                    title: {
                                        display: true,
                                        text: 'Meses'
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Gráfico Fono exames
                const fonoExamesCtx = document.getElementById('fonoExamesChart');
                if (fonoExamesCtx) {
                    // Destruir gráfico existente se houver
                    if (window.fonoExamesChartInstance) {
                        window.fonoExamesChartInstance.destroy();
                    }
                    
                    window.fonoExamesChartInstance = new Chart(fonoExamesCtx, {
                        type: 'line',
                        data: {
                            labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov'],
                            datasets: [{
                                label: 'Fono exames',
                                data: [null, null, 750.00, 4200.00, 3350.00, 5950.00, 5600.00, 5600.00, 5700.00, 4300.00, 4050.00],
                                borderColor: 'rgba(102, 126, 234, 1)',
                                backgroundColor: 'rgba(102, 126, 234, 0.1)',
                                borderWidth: 3,
                                fill: true,
                                tension: 0.4,
                                pointBackgroundColor: 'rgba(102, 126, 234, 1)',
                                pointBorderColor: '#fff',
                                pointBorderWidth: 2,
                                pointRadius: 5,
                                pointHoverRadius: 7
                            }, {
                                label: 'Teto',
                                data: [5500.00, 5500.00, 5500.00, 5500.00, 5500.00, 5500.00, 5500.00, 5500.00, 5500.00, 5500.00, 5500.00],
                                borderColor: 'rgba(255, 99, 132, 1)',
                                backgroundColor: 'rgba(255, 99, 132, 0.1)',
                                borderWidth: 2,
                                borderDash: [5, 5],
                                fill: false,
                                pointRadius: 0,
                                pointHoverRadius: 5,
                                pointHoverBackgroundColor: 'rgba(255, 99, 132, 1)',
                                pointHoverBorderColor: 'rgba(255, 99, 132, 1)'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            interaction: {
                                intersect: false,
                                mode: 'index'
                            },
                            plugins: {
                                legend: { position: 'top' },
                                tooltip: {
                                    intersect: false,
                                    mode: 'index',
                                    callbacks: {
                                        label: function(context) {
                                            let label = context.dataset.label || '';
                                            if (label) {
                                                label += ': ';
                                            }
                                            if (context.parsed.y !== null) {
                                                label += new Intl.NumberFormat('pt-BR', {
                                                    style: 'currency',
                                                    currency: 'BRL'
                                                }).format(context.parsed.y);
                                            }
                                            return label;
                                        }
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    ticks: {
                                        callback: function(value) {
                                            return 'R$ ' + value.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                                        }
                                    },
                                    title: {
                                        display: true,
                                        text: 'Valor (R$)'
                                    }
                                },
                                x: {
                                    title: {
                                        display: true,
                                        text: 'Meses'
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Gráfico Terapia Ocupacional
                const terapiaOcupacionalCtx = document.getElementById('terapiaOcupacionalChart');
                if (terapiaOcupacionalCtx) {
                    // Destruir gráfico existente se houver
                    if (window.terapiaOcupacionalChartInstance) {
                        window.terapiaOcupacionalChartInstance.destroy();
                    }
                    
                    window.terapiaOcupacionalChartInstance = new Chart(terapiaOcupacionalCtx, {
                        type: 'line',
                        data: {
                            labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov'],
                            datasets: [{
                                label: 'Terapia Ocupacional',
                                data: [2775.00, 3250.00, 2962.50, 3800.00, 3800.00, 2763.00, 2229.00, 3649.00, 5051.00, 4685.00, 2653.00],
                                borderColor: 'rgba(102, 126, 234, 1)',
                                backgroundColor: 'rgba(102, 126, 234, 0.1)',
                                borderWidth: 3,
                                fill: true,
                                tension: 0.4,
                                pointBackgroundColor: 'rgba(102, 126, 234, 1)',
                                pointBorderColor: '#fff',
                                pointBorderWidth: 2,
                                pointRadius: 5,
                                pointHoverRadius: 7
                            }, {
                                label: 'Teto',
                                data: [4930.00, 4930.00, 4930.00, 4930.00, 4930.00, 4930.00, 4930.00, 4930.00, 4930.00, 4930.00, 4930.00],
                                borderColor: 'rgba(255, 99, 132, 1)',
                                backgroundColor: 'rgba(255, 99, 132, 0.1)',
                                borderWidth: 2,
                                borderDash: [5, 5],
                                fill: false,
                                pointRadius: 0,
                                pointHoverRadius: 5,
                                pointHoverBackgroundColor: 'rgba(255, 99, 132, 1)',
                                pointHoverBorderColor: 'rgba(255, 99, 132, 1)'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            interaction: {
                                intersect: false,
                                mode: 'index'
                            },
                            plugins: {
                                legend: { position: 'top' },
                                tooltip: {
                                    intersect: false,
                                    mode: 'index',
                                    callbacks: {
                                        label: function(context) {
                                            let label = context.dataset.label || '';
                                            if (label) {
                                                label += ': ';
                                            }
                                            if (context.parsed.y !== null) {
                                                label += new Intl.NumberFormat('pt-BR', {
                                                    style: 'currency',
                                                    currency: 'BRL'
                                                }).format(context.parsed.y);
                                            }
                                            return label;
                                        }
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    ticks: {
                                        callback: function(value) {
                                            return 'R$ ' + value.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                                        }
                                    },
                                    title: {
                                        display: true,
                                        text: 'Valor (R$)'
                                    }
                                },
                                x: {
                                    title: {
                                        display: true,
                                        text: 'Meses'
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Gráfico Projeto Neurodivergentes
                const projetoNeurodivergentesCtx = document.getElementById('projetoNeurodivergentesChart');
                if (projetoNeurodivergentesCtx) {
                    // Destruir gráfico existente se houver
                    if (window.projetoNeurodivergentesChartInstance) {
                        window.projetoNeurodivergentesChartInstance.destroy();
                    }
                    
                    window.projetoNeurodivergentesChartInstance = new Chart(projetoNeurodivergentesCtx, {
                        type: 'bar',
                        data: {
                            labels: ['Projeto Neurodivergentes'],
                            datasets: [{
                                label: 'Neuropediatra',
                                data: [14760.00],
                                backgroundColor: 'rgba(102, 126, 234, 0.8)',
                                borderColor: 'rgba(102, 126, 234, 1)',
                                borderWidth: 2,
                                stack: 'stack1'
                            }, {
                                label: 'Fonoaudiologia',
                                data: [6000.00],
                                backgroundColor: 'rgba(16, 185, 129, 0.8)',
                                borderColor: 'rgba(16, 185, 129, 1)',
                                borderWidth: 2,
                                stack: 'stack1'
                            }, {
                                label: 'Terapia Ocupacional',
                                data: [4930.00],
                                backgroundColor: 'rgba(245, 158, 11, 0.8)',
                                borderColor: 'rgba(245, 158, 11, 1)',
                                borderWidth: 2,
                                stack: 'stack1'
                            }, {
                                label: 'Psicologia',
                                data: [3500.00],
                                backgroundColor: 'rgba(239, 68, 68, 0.8)',
                                borderColor: 'rgba(239, 68, 68, 1)',
                                borderWidth: 2,
                                stack: 'stack1'
                            }, {
                                label: 'Teto do Projeto',
                                data: [30320.61],
                                type: 'line',
                                yAxisID: 'y',
                                borderColor: 'rgba(255, 99, 132, 1)',
                                backgroundColor: 'rgba(255, 99, 132, 0.1)',
                                borderWidth: 3,
                                borderDash: [5, 5],
                                fill: false,
                                pointRadius: 5,
                                pointHoverRadius: 7,
                                pointBackgroundColor: 'rgba(255, 99, 132, 1)',
                                pointBorderColor: '#fff',
                                pointBorderWidth: 2,
                                tension: 0,
                                order: 0
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { position: 'top' },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            const label = context.dataset.label || '';
                                            const value = context.parsed.y;
                                            return `${label}: R$ ${value.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
                                        }
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    id: 'y',
                                    beginAtZero: true,
                                    max: 50000,
                                    stacked: true,
                                    ticks: {
                                        callback: function(value) {
                                            return 'R$ ' + value.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                                        }
                                    },
                                    title: {
                                        display: true,
                                        text: 'Valor (R$)'
                                    }
                                },
                                x: {
                                    stacked: true,
                                    title: {
                                        display: false
                                    }
                                }
                            },
                            interaction: {
                                intersect: false,
                                mode: 'index'
                            }
                        }
                    });
                }
                return;
            }
            
            if (slideIndex === 5) { // Slide 6: Farmácia
                // Gráfico de Custos Médios da Farmácia
                const farmaciaCustosCtx = document.getElementById('farmaciaCustosChart');
                if (farmaciaCustosCtx) {
                    // Destruir gráfico existente se houver
                    if (window.farmaciaCustosChartInstance) {
                        window.farmaciaCustosChartInstance.destroy();
                    }
                    
                    // Criar gradientes para as barras
                    const ctx = farmaciaCustosCtx.getContext('2d');
                    const gradient1 = ctx.createLinearGradient(0, 0, 0, 400);
                    gradient1.addColorStop(0, 'rgba(34, 197, 94, 0.9)');
                    gradient1.addColorStop(1, 'rgba(22, 163, 74, 0.9)');
                    
                    const gradient2 = ctx.createLinearGradient(0, 0, 0, 400);
                    gradient2.addColorStop(0, 'rgba(59, 130, 246, 0.9)');
                    gradient2.addColorStop(1, 'rgba(37, 99, 235, 0.9)');
                    
                    const gradient3 = ctx.createLinearGradient(0, 0, 0, 400);
                    gradient3.addColorStop(0, 'rgba(168, 85, 247, 0.9)');
                    gradient3.addColorStop(1, 'rgba(147, 51, 234, 0.9)');
                    
                    window.farmaciaCustosChartInstance = new Chart(farmaciaCustosCtx, {
                        type: 'bar',
                        data: {
                            labels: ['Custos Médios da Farmácia'],
                            datasets: [{
                                label: 'Projeto Bexiga Neurogênica',
                                data: [66260.35],
                                backgroundColor: gradient1,
                                borderColor: 'rgba(34, 197, 94, 1)',
                                borderWidth: 2,
                                borderRadius: 8,
                                borderSkipped: false,
                                stack: 'stack1'
                            }, {
                                label: 'Projeto Ostomia',
                                data: [15770.25],
                                backgroundColor: gradient2,
                                borderColor: 'rgba(59, 130, 246, 1)',
                                borderWidth: 2,
                                borderRadius: 8,
                                borderSkipped: false,
                                stack: 'stack1'
                            }, {
                                label: 'Insumos Assistenciais',
                                data: [21214.57],
                                backgroundColor: gradient3,
                                borderColor: 'rgba(168, 85, 247, 1)',
                                borderWidth: 2,
                                borderRadius: 8,
                                borderSkipped: false,
                                stack: 'stack1'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            indexAxis: 'y',
                            plugins: {
                                legend: {
                                    position: 'right',
                                    labels: {
                                        padding: 15,
                                        font: {
                                            size: 13,
                                            weight: '500'
                                        },
                                        usePointStyle: true,
                                        pointStyle: 'circle'
                                    }
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            const label = context.dataset.label || '';
                                            const value = context.parsed.x;
                                            return `${label}: R$ ${value.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
                                        },
                                        footer: function(tooltipItems) {
                                            let total = 0;
                                            tooltipItems.forEach(function(tooltipItem) {
                                                total += tooltipItem.parsed.x;
                                            });
                                            return 'Total: R$ ' + total.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                                        }
                                    }
                                },
                            },
                            scales: {
                                x: {
                                    stacked: true,
                                    beginAtZero: true,
                                    ticks: {
                                        callback: function(value) {
                                            return 'R$ ' + (value/1000).toFixed(0) + 'k';
                                        },
                                        font: {
                                            size: 12
                                        }
                                    },
                                    title: {
                                        display: true,
                                        text: 'Valor (R$)',
                                        font: {
                                            size: 14,
                                            weight: 'bold'
                                        }
                                    },
                                    grid: {
                                        color: 'rgba(0, 0, 0, 0.05)'
                                    }
                                },
                                y: {
                                    stacked: true,
                                    ticks: {
                                        font: {
                                            size: 12
                                        }
                                    },
                                    grid: {
                                        display: false
                                    }
                                }
                            },
                            layout: {
                                padding: {
                                    top: 20,
                                    bottom: 20,
                                    left: 20,
                                    right: 20
                                }
                            }
                        },
                        plugins: [{
                            id: 'datalabels',
                            afterDatasetsDraw: (chart) => {
                                const ctx = chart.ctx;
                                
                                chart.data.datasets.forEach((dataset, datasetIndex) => {
                                    const meta = chart.getDatasetMeta(datasetIndex);
                                    meta.data.forEach((bar, index) => {
                                        const value = dataset.data[index];
                                        if (value > 0 && bar.width > 0) {
                                            // Para barras horizontais empilhadas, usar base e x
                                            const startX = bar.base;
                                            const endX = bar.x;
                                            const segmentCenterX = (startX + endX) / 2;
                                            const y = bar.y;
                                            
                                            ctx.save();
                                            ctx.fillStyle = '#fff';
                                            ctx.font = 'bold 12px Arial';
                                            ctx.textAlign = 'center';
                                            ctx.textBaseline = 'middle';
                                            
                                            const formattedValue = 'R$ ' + (value/1000).toFixed(1) + 'k';
                                            ctx.fillText(formattedValue, segmentCenterX, y);
                                            ctx.restore();
                                        }
                                    });
                                });
                            }
                        }]
                    });
                }
            }
            
            if (slideIndex === 6) { // Slide 7: Análise de Saídas (sem gráficos)
                return;
            }
            
            if (slideIndex === 7) { // Slide 8: Análise de Produtos (sem gráficos)
                return;
            }
            
            if (slideIndex === 8) { // Slide 9: Empréstimos (sem gráficos)
                return;
            }
            
            if (slideIndex === 10) { // Slide 11: Cronogramas e Atividades
                // Gráfico de pizza - Fonoaudiologia
                const neuropediatriaFonoCtx = document.getElementById('neuropediatriaFonoChart');
                if (neuropediatriaFonoCtx) {
                    // Destruir gráfico existente se houver
                    if (window.neuropediatriaFonoChartInstance) {
                        window.neuropediatriaFonoChartInstance.destroy();
                    }
                    
                    window.neuropediatriaFonoChartInstance = new Chart(neuropediatriaFonoCtx, {
                        type: 'pie',
                        data: {
                            labels: [
                                'Ansiedade',
                                'Depressão',
                                'Outros Traumas'
                            ],
                            datasets: [{
                                data: [75, 15, 10],
                                backgroundColor: [
                                    '#FF6384', // Vermelho para ansiedade
                                    '#36A2EB', // Azul para depressão
                                    '#FFCE56'  // Amarelo para outros traumas
                                ],
                                borderWidth: 2,
                                borderColor: '#fff'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        generateLabels: function(chart) {
                                            const data = chart.data;
                                            if (data.labels.length && data.datasets.length) {
                                                const dataset = data.datasets[0];
                                                return data.labels.map((label, i) => {
                                                    const value = dataset.data[i];
                                                    return {
                                                        text: `${label}: ${value}%`,
                                                        fillStyle: dataset.backgroundColor[i],
                                                        strokeStyle: dataset.borderColor,
                                                        lineWidth: dataset.borderWidth,
                                                        hidden: false,
                                                        index: i
                                                    };
                                                });
                                            }
                                            return [];
                                        }
                                    }
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            const label = context.label || '';
                                            const value = context.parsed;
                                            return `${label}: ${value}%`;
                                        }
                                    }
                                }
                            }
                        }
                    });
                }
            }
            
        }
        
        // Função para criar tabela de gastos por setor
        function createGastosTable() {
            const gastosData = {
                setores: [
                    'Centro de Diagnósticos', 'Bloco Cirúrgico', 'Enfermaria', 'CME', 'Mamografia', 
                    'Ambulatório Geral', 'Fisioterapia', 'Fonoaudiologia', 'SESMT', 'Nutricionista', 'Limpeza e Higienização'
                ],
                valores: [71812.96, 61471.81, 25736.87, 17178.96, 11047.69, 13675.08, 1246.02, 1259.75, 1044.80, 225.67, 102.27]
            };
            
            const tableBody = document.getElementById('gastosTableBody');
            if (tableBody) {
                tableBody.innerHTML = '';
                
                const totalGeral = gastosData.valores.reduce((a, b) => a + b, 0);
                
                // Criar array com setores e valores para ordenar
                const setoresOrdenados = gastosData.setores.map((setor, index) => ({
                    setor: setor,
                    valor: gastosData.valores[index],
                    indice: index
                })).sort((a, b) => b.valor - a.valor);
                
                setoresOrdenados.forEach((item, index) => {
                    const porcentagem = ((item.valor / totalGeral) * 100).toFixed(1);
                    const posicao = index + 1;
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td style="font-weight: 600;">${item.setor}</td>
                        <td style="font-weight: 600; color: #667eea;">R$ ${item.valor.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</td>
                        <td style="font-weight: 600; color: #28a745;">${porcentagem}%</td>
                        <td style="text-align: center; font-weight: 600; color: #ffc107;">${posicao}º</td>
                    `;
                    
                    // Destacar os 3 setores com maior gasto
                    if (index < 3) {
                        row.style.backgroundColor = '#f0f4ff';
                        row.style.borderLeft = '4px solid #667eea';
                    }
                    
                    tableBody.appendChild(row);
                });
            }
        }

        // Função para criar tabela de especialidades
        function createEspecialidadesTable() {
            const especialidadesData = {
                labels: ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto'],
                custos: [77825.11, 91216.56, 71910.69, 74886.30, 79562.65, 69107.47, 80557.04, 76818.95],
                teto: 75844.46,
                ostomia: [18467.52, 17812.64, 15949.91, 15382.94, 14168.62, 12066.29, 18224.11, 14089.39],
                peDiabetico: [89.69, 70.34, 8.15, 23.74, 91.78, 44.47, 96.24, 382.65],
                bexigaNeurogenica: [59267.90, 59333.58, 55952.63, 59479.62, 65302.25, 56996.71, 62236.69, 62346.91]
            };
            
            const tableBody = document.getElementById('especialidadesTableBody');
            if (tableBody) {
                tableBody.innerHTML = '';
                
                especialidadesData.labels.forEach((mes, index) => {
                    const custo = especialidadesData.custos[index];
                    const isOver = custo > especialidadesData.teto;
                    const diferenca = Math.abs(custo - especialidadesData.teto);
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td style="font-weight: 600;">${mes}</td>
                        <td>R$ ${especialidadesData.ostomia[index].toLocaleString('pt-BR', {minimumFractionDigits: 2})}</td>
                        <td>R$ ${especialidadesData.peDiabetico[index].toLocaleString('pt-BR', {minimumFractionDigits: 2})}</td>
                        <td>R$ ${especialidadesData.bexigaNeurogenica[index].toLocaleString('pt-BR', {minimumFractionDigits: 2})}</td>
                        <td style="font-weight: 600;">R$ ${custo.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</td>
                        <td>R$ ${especialidadesData.teto.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</td>
                        <td style="color: ${isOver ? '#dc3545' : '#28a745'}; font-weight: 600;">
                            ${isOver ? 
                                ` R$ ${diferenca.toLocaleString('pt-BR', {minimumFractionDigits: 2})} acima` : 
                                ` R$ ${diferenca.toLocaleString('pt-BR', {minimumFractionDigits: 2})} abaixo`
                            }
                        </td>
                    `;
                    
                    if (isOver) {
                        row.style.backgroundColor = '#fff5f5';
                    }
                    
                    tableBody.appendChild(row);
                });
            }
        }
        
    </script>
    
    <!-- Modal para ampliar imagem -->
    <div id="imageModal" class="image-modal">
        <span class="image-modal-close">&times;</span>
        <img class="image-modal-content" id="modalImage" src="" alt="Imagem ampliada">
    </div>
    
    <script>
        // Funcionalidade para ampliar imagem da Ação da TI
        const acaoTiImage = document.getElementById('acaoTiImage');
        const imageModal = document.getElementById('imageModal');
        const modalImage = document.getElementById('modalImage');
        const closeModal = document.querySelector('.image-modal-close');
        
        if (acaoTiImage) {
            acaoTiImage.addEventListener('click', function() {
                modalImage.src = this.src;
                imageModal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            });
        }
        
        // Funcionalidade para ampliar imagem do Controle de Formaldeído
        const controleImage = document.getElementById('controleImage');
        if (controleImage) {
            controleImage.addEventListener('click', function() {
                modalImage.src = this.src;
                imageModal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            });
        }
        
        if (closeModal) {
            closeModal.addEventListener('click', function() {
                imageModal.style.display = 'none';
                document.body.style.overflow = 'auto';
            });
        }
        
        if (imageModal) {
            imageModal.addEventListener('click', function(e) {
                if (e.target === imageModal) {
                    imageModal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
            });
        }
        
        // Fechar modal com tecla ESC
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && imageModal.style.display === 'block') {
                imageModal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        });
    </script>
    
    </div> <!-- Fechamento da div presentation-container -->
</body>
</html>
